machine:
  python:
    version: 2.7.3
  services:
    - docker

environment:
  do_version: v3

dependencies:
  pre:
    - pip install requirements-txt
    - easy_install awscli
    - docker build -t sibymath/circletest:$do_version .

test:
  post:
    - docker run -d -p 5000:5000 sibymath/circletest:$do_version; sleep 10
    - curl http://localhost:5000/1/ping

deployment:
  elasticbeanstalk:
    branch: master
    commands:
      - docker login -e siby.math@gmail.com -u sibymath -p Ruckus2015
      - ./deploy.sh
